import requests
import time
import os
from dotenv import load_dotenv
load_dotenv()


PERPLEXITY_API_KEY = os.environ["PERPLEXITY_API_KEY"]
ARTICLE = """Skip to content


Register

Sign In
Home
News
Sport
Business
Innovation
Culture
Arts
Travel
Earth
Audio
Video
Live
Israel security cabinet approves plan to 'capture' Gaza, official says
47 minutes ago

Share

Save
David Gritten
BBC News
Reporting fromJerusalem
Reuters File photo showing Israeli tanks entering Israel from Gaza (18 March 2025)Reuters
The Israeli military has called up tens of thousands of reservists, saying it is aiming to increase pressure on Hamas
Israel's security cabinet has approved a plan to expand its military offensive against Hamas which includes the "capture" of Gaza and the holding of its territory, according to an Israeli official.

Prime Minister Benjamin Netanyahu said the cabinet had decided on a "forceful operation" to destroy Hamas and rescue its remaining hostages, and that Gaza's 2.1 million population "will be moved, to protect it".

He did not say how much territory would be seized by troops, but he stressed that "they will not enter and come out".

The cabinet also approved, in principle, a plan to deliver aid through private companies, which would end a two-month blockade the UN says has caused severe food shortages.

The UN and other aid agencies have said the proposal would be a breach of basic humanitarian principles and that they will not co-operate.

A Hamas official said the group rejected Israel's "pressure and blackmail".

Asked about the Israeli plan to expand its offensive, President Donald Trump repeated a pledge to help get food to Palestinians there.

The UK meanwhile said it "does not support an expansion of Israel's military operations in Gaza". The EU earlier urged restraint, saying it was concerned about "further casualties and suffering for the Palestinian population".

Israeli army starts calling up reservists for planned expansion to Gaza offensive
Gaza kitchens warn food will run out in days after two months of Israeli blockade
Israeli reservists speak out against Gaza war as pressure on Netanyahu grows
Israel's security cabinet met on Sunday evening to discuss the Gaza offensive, which resumed when Israel ended a two-month ceasefire on 18 March.

An Israeli official who briefed the media on Monday morning said ministers voted unanimously to approve a plan proposed by the Israeli military's Chief of Staff Lt Gen Eyal Zamir to "defeat Hamas in Gaza and return the hostages".

"The plan will include, among other things, the capture of the Strip and holding the territories, moving the Gazan population south for its defence, denying Hamas the ability to distribute humanitarian supplies, and powerful attacks against Hamas," the official said.

Israeli media reported that first stage would include the seizure of additional areas of Gaza and the expansion of the Israeli-designated "buffer zone" running along the territory's borders. It would aim to give Israel additional leverage in negotiations with Hamas on a new ceasefire and hostage release deal.

Later, a senior Israeli security official said the plan would not be implemented until after US President Donald Trump's visit to the region between 13 and 16 May, providing what he called "a window of opportunity" to Hamas to agree a new ceasefire and hostage release deal.

Trump will visit Saudi Arabia, United Arab Emirates and Qatar on his trip.

Far-right Finance Minister Bezalel Smotrich meanwhile told a conference in Jerusalem on Monday that Israel was "going to finally occupy the Gaza Strip", according to Reuters news agency.

Israel occupied Gaza in the 1967 Middle East war along with the West Bank. It unilaterally withdrew troops and settlers from Gaza in 2005, but the UN still regards Gaza as Israeli-occupied territory because it retained control of Gaza's shared border, airspace and shoreline.

In a briefing later on Monday, the Israel Defense Forces (IDF) said the expanded campaign would displace most Palestinians in Gaza as air strikes and other military operations continued.

However, critics say military action has failed to secure the return of the 59 remaining hostages - up to 24 of whom are believed to be alive - and have urged the government to strike a deal with Hamas.

The Hostages and Missing Families Forum, which represents hostages' relatives, said the plan was an admission by the government that it was "choosing territories over the hostages" and that this was "against the will of over 70% of the people" in Israel.

Hamas official Mahmoud Mardawi reiterated that the group wanted a comprehensive deal, including "a complete ceasefire, full withdrawal from Gaza, reconstruction of the Gaza Strip, and the release of all prisoners from both sides".

Palestinians in north Gaza told the BBC that they were strongly opposed to being forcibly displaced to the south once again, with several saying they would rather die amid the ruins of their homes.

"In October 2023, I evacuated with my children, daughters, and grandchildren - about 60 people in total," 76-year-old Gaza City resident Ahmed Shehata said.

"We lived through unbearable conditions in what Israel claimed was a 'safe zone' in the south. This time, we will not leave, even if Israel brings down the tents over our heads."

Osama Tawfiq, a 48-year-old father of five, said: "Israeli threats won't scare us. We are staying in Gaza."

EPA Palestinians hold out pans at a community kitchen in Khan Younis, southern Gaza (2 May 2025)EPA
Gaza's community kitchens say they are days away from running out of supplies
The Israeli official said the security cabinet also approved by a large majority "the possibility of humanitarian [aid] distribution - if necessary - that would prevent Hamas from taking control of supplies and would destroy its governmental capabilities".

The security official said deliveries would resume once the expanded offensive began, and that the military would establish a "sterile area" in the southern Rafah area that Palestinians would be able to enter pending inspection.

On Sunday, the Humanitarian Country Team (HCT), a forum that includes UN agencies, said Israeli officials were seeking to "shut down the existing aid distribution system" and "have us agree to deliver supplies through Israeli hubs under conditions set by the Israeli military, once the government agrees to re-open crossings".

The HCT warned that the plan would mean large parts of Gaza, including less mobile and most vulnerable people, would continue to go without supplies.

"It contravenes fundamental humanitarian principles and appears designed to reinforce control over life-sustaining items as a pressure tactic – as part of a military strategy," it said.

"It is dangerous, driving civilians into militarized zones to collect rations, threatening lives, including those of humanitarian workers, while further entrenching forced displacement."

Israel cut off all deliveries of humanitarian aid and other supplies to Gaza aid on 2 March, two weeks before resuming its offensive.

According to the UN, the population is facing a renewed risk of hunger and malnutrition because warehouses are empty, bakeries have shut, and community kitchens are days away from running out of supplies.

The blockade has also cut off essential medicines, vaccines and medical equipment needed by Gaza's overwhelmed healthcare system.

The UN says Israel is obliged under international law to ensure supplies for Gaza's population, almost all of whom have been displaced. Israel says it is complying with international law and there is no shortage of aid.

The Israeli military launched a campaign to destroy Hamas in response to an unprecedented cross-border attack on 7 October 2023, in which about 1,200 people were killed and 251 others were taken hostage.

At least 52,567 people have been killed in Gaza since then, including 2,459 since the Israeli offensive resumed, according to the territory's Hamas-run health ministry.

Israel-Gaza war
Israel
Palestinian territories
Hamas
Related
Americans used to be steadfast in their support for Israel. Those days are gone
Just now
BBC InDepth
Popemobile to become health clinic for Gaza children
12 hrs ago
Europe
Israeli army starts calling up reservists for planned expansion to Gaza offensive
21 hrs ago
Middle East
More
2 hrs ago
Police officers guard as a tractor works at a scene where the ballistic missile landed
Israel strikes Houthi targets in Yemen a day after missile attack near airport
A spokesman for the Houthi-run health ministry said at least 21 people were injured in the attack.

Middle East
1 day ago
Israeli emergency services clear a road outside Israel's Ben Gurion airport. 
Netanyahu vows response after Houthi missile hits near Israel's main airport
Footage appeared to show a plume of black smoke rising from an area near the airport on the outskirts of Tel Aviv.

Middle East
3 days ago
A man wearing headdress looks at the camera with a far off background behind him 
'I saved my ID card and my dog': Israel expands demolitions of West Bank refugee homes
Jumaa Zawayda didn't know if his home was among those destroyed after Israel ordered thousands to evacuate Jenin.

Middle East
3 days ago
Syrian security forces deployed on a street in the town of Sahnaya, south of Damascus, Syria (1 May 2025)
Israel says it struck near Syria palace over violence in Druze areas
Israel's PM says it will "not allow any threat" to the minority in Syria after sectarian clashes in which dozens were killed.

Middle East
3 days ago
activist boat
Activists say ship aiming to sail to Gaza was attacked by drones
The incident happened off the coast of Malta. The government said a fire onboard the ship was "brought under control overnight".

Middle East
Home
News
Sport
Business
Innovation
Culture
Arts
Travel
Earth
Audio
Video
Live
Weather
BBC Shop
BritBox
BBC in other languages
Follow BBC on:






Terms of Use
About the BBC
Privacy Policy
Cookies
Accessibility Help
Contact the BBC
Advertise with us
Do not share or sell my info
Contact technical support
Copyright 2025 BBC. All rights reserved.  The BBC is not responsible for the content of external sites. Read about our approach to external linking.

 

"""

def split_by_length(text, max_len=5000):
    return [text[i:i+max_len] for i in range(0, len(text), max_len)]

def ask_perplexity(article):
    prompt = (
        "#Order\n以下の英語記事テキストから、本文以外の余分な情報（ナビゲーション、広告、フッター、著作権表示、関連記事リスト等）をすべて除去し、「記事本文」だけを抽出してください。"
        "本文そのものの内容・文は一切改変しないでください。\n\n"
        "#Output format (STRICTLY JSON ONLY, NO explanation, NO code block, NO extra text. Output ONLY valid JSON object!):\n"
        "{\n  \"cleaned_article\": \"（本文のみ）\"\n}\n#Input\n" + article
    )
    headers = {
        "Authorization": f"Bearer {PERPLEXITY_API_KEY}",
        "Content-Type": "application/json"
    }
    data = {
        "model": "sonar",
        "messages": [{"role": "user", "content": prompt}]
    }
    res = requests.post("https://api.perplexity.ai/chat/completions", headers=headers, json=data)
    return res.json()

if __name__ == "__main__":
    # 1. 全文一括
    start = time.time()
    full_res = ask_perplexity(ARTICLE)
    end = time.time()
    print("=== 全文一括 ===")
    print("所要時間:", round(end - start, 2), "秒")
    print("整形結果:", full_res)

    # 2. 5000文字ごと分割
    parts = split_by_length(ARTICLE, 5000)
    merged = ""
    start = time.time()
    for part in parts:
        res = ask_perplexity(part)
        content = res.get("choices", [{}])[0].get("message", {}).get("content", "")
        merged += content
    end = time.time()
    print("=== 5000文字ごと分割 ===")
    print("所要時間:", round(end - start, 2), "秒")
    print("整形結果:", merged) 